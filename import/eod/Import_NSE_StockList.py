from config.nse_connection import nse
from config.postgres_connection import *

nifty50 = ['TATAMOTORS','UPL','ONGC','VEDL','HINDALCO','JSWSTEEL','HCLTECH','HEROMOTOCO','INFRATEL','GAIL','COALINDIA','NTPC','TCS','WIPRO','INFY','M&M','MARUTI','TATASTEEL','BAJAJ-AUTO','TITAN','IOC','HDFC','BHARTIARTL','TECHM','BPCL','POWERGRID','ULTRACEMCO','RELIANCE','LT','HDFCBANK','NESTLEIND','EICHERMOT','SHREECEM','KOTAKBANK','ICICIBANK','BAJAJFINSV','DRREDDY','GRASIM','AXISBANK','ADANIPORTS','BAJFINANCE','ZEEL','BRITANNIA','SBIN','ASIANPAINT','ITC','INDUSINDBK','CIPLA','HINDUNILVR','SUNPHARMA']
nifty100 = ['ACC','ADANIPORTS','ADANITRANS','AMBUJACEM','ASHOKLEY','ASIANPAINT','AUROPHARMA','DMART','AXISBANK','BAJAJ-AUTO','BAJFINANCE','BAJAJFINSV','BAJAJHLDNG','BANDHANBNK','BANKBARODA','BERGEPAINT','BPCL','BHARTIARTL','INFRATEL','BIOCON','BOSCHLTD','BRITANNIA','CADILAHC','CIPLA','COALINDIA','COLPAL','CONCOR','DLF','DABUR','DIVISLAB','DRREDDY','EICHERMOT','GAIL','GICRE','GODREJCP','GRASIM','HCLTECH','HDFCAMC','HDFCBANK','HDFCLIFE','HAVELLS','HEROMOTOCO','HINDALCO','HINDPETRO','HINDUNILVR','HINDZINC','HDFC','ICICIBANK','ICICIGI','ICICIPRULI','ITC','IBULHSGFIN','IOC','INDUSINDBK','INFY','INDIGO','JSWSTEEL','KOTAKBANK','L&TFH','LT','LUPIN','M&M','MARICO','MARUTI','MOTHERSUMI','NHPC','NMDC','NTPC','NESTLEIND','ONGC','OFSS','PAGEIND','PETRONET','PIDILITIND','PEL','PFC','POWERGRID','PGHH','PNB','RELIANCE','SBILIFE','SHREECEM','SRTRANSFIN','SIEMENS','SBIN','SUNPHARMA','TCS','TATAMTRDVR','TATAMOTORS','TATASTEEL','TECHM','NIACL','TITAN','UPL','ULTRACEMCO','UBL','MCDOWELL-N','VEDL','IDEA','WIPRO','ZEEL']
nifty500 = ['3MINDIA','ACC','AIAENG','APLAPOLLO','AUBANK','AARTIIND','AAVAS','ABBOTINDIA','ADANIGAS','ADANIGREEN','ADANIPORTS','ADANIPOWER','ADANITRANS','ABCAPITAL','ABFRL','ADVENZYMES','AEGISCHEM','AFFLE','AJANTPHARM','AKZOINDIA','APLLTD','ALKEM','ALLCARGO','AMARAJABAT','AMBER','AMBUJACEM','APOLLOHOSP','APOLLOTYRE','ARVINDFASN','ASAHIINDIA','ASHOKLEY','ASHOKA','ASIANPAINT','ASTERDM','ASTRAZEN','ASTRAL','ATUL','AUROPHARMA','AVANTIFEED','DMART','AXISBANK','BASF','BEML','BSE','BAJAJ-AUTO','BAJAJCON','BAJAJELEC','BAJFINANCE','BAJAJFINSV','BAJAJHLDNG','BALKRISIND','BALMLAWRIE','BALRAMCHIN','BANDHANBNK','BANKBARODA','BANKINDIA','MAHABANK','BATAINDIA','BAYERCROP','BERGEPAINT','BDL','BEL','BHARATFORG','BHEL','BPCL','BHARTIARTL','INFRATEL','BIOCON','BIRLACORPN','BSOFT','BLISSGVS','BLUEDART','BLUESTARCO','BBTC','BOMDYEING','BOSCHLTD','BRIGADE','BRITANNIA','CARERATING','CCL','CESC','CRISIL','CADILAHC','CANFINHOME','CANBK','CAPLIPOINT','CGCL','CARBORUNIV','CASTROLIND','CEATLTD','CENTRALBK','CDSL','CENTURYPLY','CERA','CHALET','CHAMBLFERT','CHENNPETRO','CHOLAHLDNG','CHOLAFIN','CIPLA','CUB','COALINDIA','COCHINSHIP','COLPAL','CONCOR','COROMANDEL','CREDITACC','CROMPTON','CUMMINSIND','CYIENT','DBCORP','DCBBANK','DCMSHRIRAM','DLF','DABUR','DALBHARAT','DEEPAKNTR','DELTACORP','DHFL','DBL','DISHTV','DCAL','DIVISLAB','DIXON','LALPATHLAB','DRREDDY','EIDPARRY','EIHOTEL','EDELWEISS','EICHERMOT','ELGIEQUIP','EMAMILTD','ENDURANCE','ENGINERSIN','EQUITAS','ERIS','ESCORTS','ESSELPACK','EXIDEIND','FDC','FEDERALBNK','FMGOETZE','FINEORG','FINCABLES','FINPIPE','FSL','FORTIS','FCONSUMER','FLFL','FRETAIL','GAIL','GEPIL','GET&D','GHCL','GMRINFRA','GALAXYSURF','GARFIBRES','GAYAPROJ','GICRE','GILLETTE','GLAXO','GLENMARK','GODFRYPHLP','GODREJAGRO','GODREJCP','GODREJIND','GODREJPROP','GRANULES','GRAPHITE','GRASIM','GESHIP','GREAVESCOT','GRINDWELL','GUJALKALI','GUJGASLTD','GMDCLTD','GNFC','GPPL','GSFC','GSPL','GULFOILLUB','HEG','HCLTECH','HDFCAMC','HDFCBANK','HDFCLIFE','HFCL','HATSUN','HAVELLS','HEIDELBERG','HERITGFOOD','HEROMOTOCO','HEXAWARE','HSCL','HIMATSEIDE','HINDALCO','HAL','HINDCOPPER','HINDPETRO','HINDUNILVR','HINDZINC','HONAUT','HUDCO','HDFC','ICICIBANK','ICICIGI','ICICIPRULI','ISEC','ICRA','IDBI','IDFCFIRSTB','IDFC','IFBIND','IFCI','IIFL','IRB','IRCON','ITC','ITDCEM','ITI','INDIACEM','ITDC','IBULHSGFIN','IBULISL','IBREALEST','IBVENTURES','INDIAMART','INDIANB','IEX','INDHOTEL','IOC','IOB','INDOSTAR','IGL','INDUSINDBK','INFIBEAM','NAUKRI','INFY','INOXLEISUR','INTELLECT','INDIGO','IPCALAB','JBCHEPHARM','JKCEMENT','JKLAKSHMI','JKPAPER','JKTYRE','JMFINANCIL','JSWENERGY','JSWSTEEL','JAGRAN','JAICORPLTD','JISLJALEQS','J&KBANK','JAMNAAUTO','JINDALSAW','JSLHISAR','JSL','JINDALSTEL','JCHAC','JUBLFOOD','JUBILANT','JUSTDIAL','JYOTHYLAB','KPRMILL','KEI','KNRCON','KPITTECH','KRBL','KAJARIACER','KALPATPOWR','KANSAINER','KTKBANK','KARURVYSYA','KSCL','KEC','KENNAMET','KIRLOSENG','KOLTEPATIL','KOTAKBANK','L&TFH','LTTS','LICHSGFIN','LAXMIMACH','LAKSHVILAS','LTI','LT','LAURUSLABS','LEMONTREE','LINDEINDIA','LUPIN','LUXIND','MASFIN','MMTC','MOIL','MRF','MAGMA','MGL','MAHSCOOTER','MAHSEAMLES','M&MFIN','M&M','MAHINDCIE','MHRIL','MAHLOG','MANAPPURAM','MRPL','MARICO','MARUTI','MFSL','METROPOLIS','MINDTREE','MINDACORP','MINDAIND','MIDHANI','MOTHERSUMI','MOTILALOFS','MPHASIS','MCX','MUTHOOTFIN','NATCOPHARM','NBCC','NCC','NESCO','NHPC','NIITTECH','NLCINDIA','NMDC','NTPC','NH','NATIONALUM','NFL','NBVENTURES','NAVINFLUOR','NESTLEIND','NETWORK18','NILKAMAL','NAM-INDIA','OBEROIRLTY','ONGC','OIL','OMAXE','OFSS','ORIENTCEM','ORIENTELEC','ORIENTREF','PCJEWELLER','PIIND','PNBHOUSING','PNCINFRA','PTC','PVR','PAGEIND','PARAGMILK','PERSISTENT','PETRONET','PFIZER','PHILIPCARB','PHOENIXLTD','PIDILITIND','PEL','POLYCAB','PFC','POWERGRID','PRAJIND','PRESTIGE','PRSMJOHNSN','PGHL','PGHH','PNB','QUESS','RBLBANK','RECLTD','RITES','RADICO','RVNL','RAIN','RAJESHEXPO','RALLIS','RCF','RATNAMANI','RAYMOND','REDINGTON','RELAXO','RELCAPITAL','RELIANCE','RELINFRA','RPOWER','REPCOHOME','RESPONIND','SHK','SBILIFE','SJVN','SKFINDIA','SRF','SADBHAV','SANOFI','SCHAEFFLER','SIS','SFL','SHILPAMED','SHOPERSTOP','SHREECEM','RENUKA','SHRIRAMCIT','SRTRANSFIN','SIEMENS','SOBHA','SOLARINDS','SONATSOFTW','SOUTHBANK','SPANDANA','SPICEJET','STARCEMENT','SBIN','SAIL','SWSOLAR','STRTECH','STAR','SUDARSCHEM','SPARC','SUNPHARMA','SUNTV','SUNCLAYLTD','SUNDARMFIN','SUNDRMFAST','SUNTECK','SUPRAJIT','SUPREMEIND','SUZLON','SWANENERGY','SYMPHONY','SYNGENE','TCIEXP','TCNSBRANDS','TTKPRESTIG','TVTODAY','TV18BRDCST','TVSMOTOR','TAKE','TASTYBITE','TCS','TATACONSUM','TATAELXSI','TATAINVEST','TATAMTRDVR','TATAMOTORS','TATAPOWER','TATASTLBSL','TATASTEEL','TEAMLEASE','TECHM','TECHNOE','NIACL','RAMCOCEM','THERMAX','THYROCARE','TIMETECHNO','TIMKEN','TITAN','TORNTPHARM','TORNTPOWER','TRENT','TRIDENT','TRITURBINE','TIINDIA','UCOBANK','UFLEX','UPL','UJJIVAN','ULTRACEMCO','UNIONBANK','UBL','MCDOWELL-N','VGUARD','VMART','VIPIND','VRLLOG','VSTIND','WABAG','VAIBHAVGBL','VAKRANGEE','VTL','VARROC','VBL','VEDL','VENKEYS','VINATIORGA','IDEA','VOLTAS','WABCOINDIA','WELCORP','WELSPUNIND','WESTLIFE','WHIRLPOOL','WIPRO','WOCKPHARMA','ZEEL','ZENSARTECH','ZYDUSWELL','ECLERX']

all_stock_codes = nse.get_stock_codes()

print("Length : %d" % len (all_stock_codes))

sql = """INSERT INTO stock_list(stock_code,stock_description,nifty50,nifty100,nifty500)
            VALUES(%s,%s,%s,%s,%s) RETURNING stock_id;"""

for stock_code in all_stock_codes:

    print(stock_code, '->', all_stock_codes[stock_code])
    nifty50Value = False
    nifty100Value = False
    nifty500Value = False

    if stock_code in nifty50:
        nifty50Value = True
    if stock_code in nifty100:
        nifty100Value = True
    if stock_code in nifty500:
        nifty500Value = True

    #cursor.execute(sql,(stock_code,all_stock_codes[stock_code],nifty50Value,nifty100Value,nifty500Value))

#connection.commit()
